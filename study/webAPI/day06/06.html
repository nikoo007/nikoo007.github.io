<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Web APIs - day06 | 前端笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="在线笔记">
    
    <link rel="preload" href="/zz-web/assets/css/0.styles.c0bfc3b1.css" as="style"><link rel="preload" href="/zz-web/assets/js/app.083f945b.js" as="script"><link rel="preload" href="/zz-web/assets/js/2.f2240049.js" as="script"><link rel="preload" href="/zz-web/assets/js/44.e1c509f1.js" as="script"><link rel="prefetch" href="/zz-web/assets/js/10.d5312b28.js"><link rel="prefetch" href="/zz-web/assets/js/11.2b6aa850.js"><link rel="prefetch" href="/zz-web/assets/js/12.2ab2992b.js"><link rel="prefetch" href="/zz-web/assets/js/13.edf2fe2f.js"><link rel="prefetch" href="/zz-web/assets/js/14.9f97b9d2.js"><link rel="prefetch" href="/zz-web/assets/js/15.0493a36c.js"><link rel="prefetch" href="/zz-web/assets/js/16.03213685.js"><link rel="prefetch" href="/zz-web/assets/js/17.73d68c4e.js"><link rel="prefetch" href="/zz-web/assets/js/18.12075e8a.js"><link rel="prefetch" href="/zz-web/assets/js/19.498e8181.js"><link rel="prefetch" href="/zz-web/assets/js/20.f2ff5235.js"><link rel="prefetch" href="/zz-web/assets/js/21.91a2fc69.js"><link rel="prefetch" href="/zz-web/assets/js/22.a727aa87.js"><link rel="prefetch" href="/zz-web/assets/js/23.380e54c9.js"><link rel="prefetch" href="/zz-web/assets/js/24.c12d12df.js"><link rel="prefetch" href="/zz-web/assets/js/25.8f557342.js"><link rel="prefetch" href="/zz-web/assets/js/26.b4ebb45d.js"><link rel="prefetch" href="/zz-web/assets/js/27.1a9df948.js"><link rel="prefetch" href="/zz-web/assets/js/28.58b2b7c8.js"><link rel="prefetch" href="/zz-web/assets/js/29.872a74a7.js"><link rel="prefetch" href="/zz-web/assets/js/3.96bb5801.js"><link rel="prefetch" href="/zz-web/assets/js/30.e767d85b.js"><link rel="prefetch" href="/zz-web/assets/js/31.2a66bb00.js"><link rel="prefetch" href="/zz-web/assets/js/32.4b3ae917.js"><link rel="prefetch" href="/zz-web/assets/js/33.a0ee48f3.js"><link rel="prefetch" href="/zz-web/assets/js/34.b1e111ac.js"><link rel="prefetch" href="/zz-web/assets/js/35.70b67615.js"><link rel="prefetch" href="/zz-web/assets/js/36.c8a1f895.js"><link rel="prefetch" href="/zz-web/assets/js/37.7830b613.js"><link rel="prefetch" href="/zz-web/assets/js/38.aaaab44a.js"><link rel="prefetch" href="/zz-web/assets/js/39.5fe7a1ec.js"><link rel="prefetch" href="/zz-web/assets/js/4.c3d1ea14.js"><link rel="prefetch" href="/zz-web/assets/js/40.54e98467.js"><link rel="prefetch" href="/zz-web/assets/js/41.4dc705c1.js"><link rel="prefetch" href="/zz-web/assets/js/42.9c9fa6be.js"><link rel="prefetch" href="/zz-web/assets/js/43.2be21763.js"><link rel="prefetch" href="/zz-web/assets/js/45.3d0ca188.js"><link rel="prefetch" href="/zz-web/assets/js/46.c08d3f05.js"><link rel="prefetch" href="/zz-web/assets/js/47.5b9b3830.js"><link rel="prefetch" href="/zz-web/assets/js/48.8dd0953b.js"><link rel="prefetch" href="/zz-web/assets/js/49.fa9cde16.js"><link rel="prefetch" href="/zz-web/assets/js/5.095b1679.js"><link rel="prefetch" href="/zz-web/assets/js/50.dd3e5c49.js"><link rel="prefetch" href="/zz-web/assets/js/51.e93f43fb.js"><link rel="prefetch" href="/zz-web/assets/js/52.00aba65d.js"><link rel="prefetch" href="/zz-web/assets/js/53.2e7de842.js"><link rel="prefetch" href="/zz-web/assets/js/54.9624d966.js"><link rel="prefetch" href="/zz-web/assets/js/6.dd5c96ae.js"><link rel="prefetch" href="/zz-web/assets/js/7.29dbb4cd.js"><link rel="prefetch" href="/zz-web/assets/js/8.dc4bd71f.js"><link rel="prefetch" href="/zz-web/assets/js/9.81b641cc.js">
    <link rel="stylesheet" href="/zz-web/assets/css/0.styles.c0bfc3b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zz-web/" class="home-link router-link-active"><img src="./logo.png" alt="前端笔记" class="logo"> <span class="site-name can-hide">前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zz-web/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程笔记" class="dropdown-title"><span class="title">课程笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程笔记" class="mobile-dropdown-title"><span class="title">课程笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          课程笔记
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zz-web/study/webAPI/day01/01.html" class="nav-link">
  WebApi
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/JS基础/js-day01/01.html" class="nav-link">
  JS基础
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Jquery/day01/01.html" class="nav-link">
  Jquery
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Eacharts/day01/01.html" class="nav-link">
  数据可视化
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Js高级/day01/JavaScript高级第01天笔记.html" class="nav-link">
  JS高级
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/AJAX/day01/01.html" class="nav-link">
  Ajax
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Git/day01/01.html" class="nav-link">
  Git
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/BigEvent/day01/01.html" class="nav-link">
  大事件
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/NodeJs/day01/01.html" class="nav-link">
  NodeJs
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Vue基础/Day01/01.html" class="nav-link">
  Vue基础
</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zz-web/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程笔记" class="dropdown-title"><span class="title">课程笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程笔记" class="mobile-dropdown-title"><span class="title">课程笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          课程笔记
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zz-web/study/webAPI/day01/01.html" class="nav-link">
  WebApi
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/JS基础/js-day01/01.html" class="nav-link">
  JS基础
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Jquery/day01/01.html" class="nav-link">
  Jquery
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Eacharts/day01/01.html" class="nav-link">
  数据可视化
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Js高级/day01/JavaScript高级第01天笔记.html" class="nav-link">
  JS高级
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/AJAX/day01/01.html" class="nav-link">
  Ajax
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Git/day01/01.html" class="nav-link">
  Git
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/BigEvent/day01/01.html" class="nav-link">
  大事件
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/NodeJs/day01/01.html" class="nav-link">
  NodeJs
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Vue基础/Day01/01.html" class="nav-link">
  Vue基础
</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/zz-web/study/webAPI/day01/01.html" class="sidebar-link">Web APIs - day01</a></li><li><a href="/zz-web/study/webAPI/day02/02.html" class="sidebar-link">Web APIs - day02</a></li><li><a href="/zz-web/study/webAPI/day03/03.html" class="sidebar-link">Web APIs - day03</a></li><li><a href="/zz-web/study/webAPI/day04/04.html" class="sidebar-link">Web APIs - day04</a></li><li><a href="/zz-web/study/webAPI/day05/05.html" class="sidebar-link">Web APIs - day05</a></li><li><a href="/zz-web/study/webAPI/day06/06.html" aria-current="page" class="active sidebar-link">Web APIs - day06</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-1-动画函数封装" class="sidebar-link">1.1. 动画函数封装</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-1-1-缓动效果原理" class="sidebar-link">1.1.1 缓动效果原理</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-1-2-动画函数多个目标值之间移动" class="sidebar-link">1.1.2 动画函数多个目标值之间移动</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-1-3-动函数添加回调函数" class="sidebar-link">1.1.3 动函数添加回调函数</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-1-4-动画完整版代码" class="sidebar-link">1.1.4 动画完整版代码:</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-2-常见网页特效案例" class="sidebar-link">1.2. 常见网页特效案例</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-2-1-案例-网页轮播图" class="sidebar-link">1.2.1 案例：网页轮播图</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-2-2-节流阀" class="sidebar-link">1.2.2. 节流阀</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-2-3-案例-返回顶部" class="sidebar-link">1.2.3. 案例：返回顶部</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-2-4-案例-筋头云案例" class="sidebar-link">1.2.4. 案例：筋头云案例</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-3-触屏事件" class="sidebar-link">1.3. 触屏事件</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-3-1-触屏事件概述" class="sidebar-link">1.3.1. 触屏事件概述</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-3-2-触摸事件对象-touchevent" class="sidebar-link">1.3.2. 触摸事件对象（TouchEvent）</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/webAPI/day06/06.html#_1-3-3-案例-移动端拖动元素" class="sidebar-link">1.3.3.案例：移动端拖动元素</a></li></ul></li><li><a href="/zz-web/study/webAPI/day07/07.html" class="sidebar-link">Web APIs - day07</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="web-apis-day06"><a href="#web-apis-day06" class="header-anchor">#</a> Web APIs - day06</h1> <blockquote><p><strong>学习目标:</strong></p> <p>能够封装简单动画函数</p> <p>能够理解缓动动画的封装</p> <p>能够使用动画函数</p> <p>能够写出网页轮播图案例</p> <p>能够写出移动端触屏事件</p></blockquote> <h2 id="_1-1-动画函数封装"><a href="#_1-1-动画函数封装" class="header-anchor">#</a> **1.1. **动画函数封装</h2> <h2 id="_1-1-1-缓动效果原理"><a href="#_1-1-1-缓动效果原理" class="header-anchor">#</a> 1.1.1 缓动效果原理</h2> <p>缓动动画就是让元素运动速度有所变化，最常见的是让速度慢慢停下来</p> <p>思路：</p> <ol><li>让盒子每次移动的距离慢慢变小，速度就会慢慢落下来。</li> <li>核心算法： (目标值 - 现在的位置)   /  10    做为每次移动的距离步长</li> <li>停止的条件是： 让当前盒子位置等于目标位置就停止定时器</li> <li>注意步长值需要取整</li></ol> <h2 id="_1-1-2-动画函数多个目标值之间移动"><a href="#_1-1-2-动画函数多个目标值之间移动" class="header-anchor">#</a> 1.1.2 动画函数多个目标值之间移动</h2> <p>可以让动画函数从 800 移动到 500。</p> <p>当我们点击按钮时候，判断步长是正值还是负值</p> <p>​ 1.如果是正值，则步长往大了取整</p> <p>​ 2.如果是负值，则步长 向小了取整</p> <h2 id="_1-1-3-动函数添加回调函数"><a href="#_1-1-3-动函数添加回调函数" class="header-anchor">#</a> 1.1.3 动函数添加回调函数</h2> <p>回调函数原理：函数可以作为一个参数。将这个函数作为参数传到另一个函数里面，当那个函数执行完之后，再执行传进去的这个函数，这个过程就叫做回调。</p> <p>回调函数写的位置：定时器结束的位置。</p> <h2 id="_1-1-4-动画完整版代码"><a href="#_1-1-4-动画完整版代码" class="header-anchor">#</a> 1.1.4 动画完整版代码:</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">animate</span><span class="token punctuation">(</span><span class="token parameter">obj<span class="token punctuation">,</span> target<span class="token punctuation">,</span> callback</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(callback);  callback = function() {}  调用的时候 callback()</span>

  <span class="token comment">// 先清除以前的定时器，只保留当前的一个定时器执行</span>
  <span class="token function">clearInterval</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  obj<span class="token punctuation">.</span>timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 步长值写到定时器的里面</span>
    <span class="token comment">// 把我们步长值改为整数 不要出现小数的问题</span>
    <span class="token comment">// var step = Math.ceil((target - obj.offsetLeft) / 10);</span>
    <span class="token keyword">var</span> step <span class="token operator">=</span> <span class="token punctuation">(</span>target <span class="token operator">-</span> obj<span class="token punctuation">.</span>offsetLeft<span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">10</span><span class="token punctuation">;</span>
    step <span class="token operator">=</span> step <span class="token operator">&gt;</span> <span class="token number">0</span> <span class="token operator">?</span> Math<span class="token punctuation">.</span><span class="token function">ceil</span><span class="token punctuation">(</span>step<span class="token punctuation">)</span> <span class="token operator">:</span> Math<span class="token punctuation">.</span><span class="token function">floor</span><span class="token punctuation">(</span>step<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>obj<span class="token punctuation">.</span>offsetLeft <span class="token operator">==</span> target<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 停止动画 本质是停止定时器</span>
      <span class="token function">clearInterval</span><span class="token punctuation">(</span>obj<span class="token punctuation">.</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 回调函数写到定时器结束里面</span>
      <span class="token comment">// if (callback) {</span>
      <span class="token comment">//     // 调用函数</span>
      <span class="token comment">//     callback();</span>
      <span class="token comment">// }</span>
      callback <span class="token operator">&amp;&amp;</span> <span class="token function">callback</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 把每次加1 这个步长值改为一个慢慢变小的值  步长公式：(目标值 - 现在的位置) / 10</span>
    obj<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> obj<span class="token punctuation">.</span>offsetLeft <span class="token operator">+</span> step <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br></div></div><h2 id="_1-2-常见网页特效案例"><a href="#_1-2-常见网页特效案例" class="header-anchor">#</a> 1.2. 常见网页特效案例</h2> <h2 id="_1-2-1-案例-网页轮播图"><a href="#_1-2-1-案例-网页轮播图" class="header-anchor">#</a> 1.2.1 案例：网页轮播图</h2> <p>轮播图也称为焦点图，是网页中比较常见的网页特效。</p> <p>功能需求：</p> <p>​ 1.鼠标经过轮播图模块，左右按钮显示，离开隐藏左右按钮。</p> <p>​ 2.点击右侧按钮一次，图片往左播放一张，以此类推，左侧按钮同理。</p> <p>​ 3.图片播放的同时，下面小圆圈模块跟随一起变化。</p> <p>​ 4.点击小圆圈，可以播放相应图片。</p> <p>​ 5.鼠标不经过轮播图，轮播图也会自动播放图片。</p> <p>​ 6.鼠标经过，轮播图模块， 自动播放停止。</p> <div class="language-js line-numbers-mode"><pre class="language-js"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;load&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. 获取元素</span>
  <span class="token keyword">var</span> arrow_l <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.arrow-l&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> arrow_r <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.arrow-r&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> focus <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.focus&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> focusWidth <span class="token operator">=</span> focus<span class="token punctuation">.</span>offsetWidth<span class="token punctuation">;</span>
  <span class="token comment">// 2. 鼠标经过focus 就显示隐藏左右按钮</span>
  focus<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mouseenter&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    arrow_l<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;block&quot;</span><span class="token punctuation">;</span>
    arrow_r<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;block&quot;</span><span class="token punctuation">;</span>
    <span class="token function">clearInterval</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 清除定时器变量</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  focus<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mouseleave&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    arrow_l<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
    arrow_r<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
    timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">//手动调用点击事件</span>
      arrow_r<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 3. 动态生成小圆圈  有几张图片，我就生成几个小圆圈</span>
  <span class="token keyword">var</span> ul <span class="token operator">=</span> focus<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;ul&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> ol <span class="token operator">=</span> focus<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.circle&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// console.log(ul.children.length);</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ul<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 创建一个小li</span>
    <span class="token keyword">var</span> li <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">&quot;li&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 记录当前小圆圈的索引号 通过自定义属性来做</span>
    li<span class="token punctuation">.</span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 把小li插入到ol 里面</span>
    ol<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>li<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 4. 小圆圈的排他思想 我们可以直接在生成小圆圈的同时直接绑定点击事件</span>
    li<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token comment">// 干掉所有人 把所有的小li 清除 current 类名</span>
      <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ol<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ol<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 留下我自己  当前的小li 设置current 类名</span>
      <span class="token keyword">this</span><span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;current&quot;</span><span class="token punctuation">;</span>
      <span class="token comment">// 5. 点击小圆圈，移动图片 当然移动的是 ul</span>
      <span class="token comment">// ul 的移动距离 小圆圈的索引号 乘以 图片的宽度 注意是负值</span>
      <span class="token comment">// 当我们点击了某个小li 就拿到当前小li 的索引号</span>
      <span class="token keyword">var</span> index <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">getAttribute</span><span class="token punctuation">(</span><span class="token string">&quot;index&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 当我们点击了某个小li 就要把这个li 的索引号给 num</span>
      num <span class="token operator">=</span> index<span class="token punctuation">;</span>
      <span class="token comment">// 当我们点击了某个小li 就要把这个li 的索引号给 circle</span>
      circle <span class="token operator">=</span> index<span class="token punctuation">;</span>
      <span class="token comment">// num = circle = index;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>focusWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>index<span class="token punctuation">)</span><span class="token punctuation">;</span>

      <span class="token function">animate</span><span class="token punctuation">(</span>ul<span class="token punctuation">,</span> <span class="token operator">-</span>index <span class="token operator">*</span> focusWidth<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 把ol里面的第一个小li设置类名为 current</span>
  ol<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;current&quot;</span><span class="token punctuation">;</span>
  <span class="token comment">// 6. 克隆第一张图片(li)放到ul 最后面</span>
  <span class="token keyword">var</span> first <span class="token operator">=</span> ul<span class="token punctuation">.</span>children<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">cloneNode</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  ul<span class="token punctuation">.</span><span class="token function">appendChild</span><span class="token punctuation">(</span>first<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 7. 点击右侧按钮， 图片滚动一张</span>
  <span class="token keyword">var</span> num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// circle 控制小圆圈的播放</span>
  <span class="token keyword">var</span> circle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token comment">// flag 节流阀</span>
  <span class="token keyword">var</span> flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
  arrow_r<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span> <span class="token comment">// 关闭节流阀</span>
      <span class="token comment">// 如果走到了最后复制的一张图片，此时 我们的ul 要快速复原 left 改为 0</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">==</span> ul<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        ul<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
        num <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      num<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token function">animate</span><span class="token punctuation">(</span>ul<span class="token punctuation">,</span> <span class="token operator">-</span>num <span class="token operator">*</span> focusWidth<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span> <span class="token comment">// 打开节流阀</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 8. 点击右侧按钮，小圆圈跟随一起变化 可以再声明一个变量控制小圆圈的播放</span>
      circle<span class="token operator">++</span><span class="token punctuation">;</span>
      <span class="token comment">// 如果circle == 4 说明走到最后我们克隆的这张图片了 我们就复原</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>circle <span class="token operator">==</span> ol<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        circle <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      <span class="token comment">// 调用函数</span>
      <span class="token function">circleChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token comment">// 9. 左侧按钮做法</span>
  arrow_l<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>flag<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      flag <span class="token operator">=</span> <span class="token boolean">false</span><span class="token punctuation">;</span>
      <span class="token keyword">if</span> <span class="token punctuation">(</span>num <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        num <span class="token operator">=</span> ul<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">;</span>
        ul<span class="token punctuation">.</span>style<span class="token punctuation">.</span>left <span class="token operator">=</span> <span class="token operator">-</span>num <span class="token operator">*</span> focusWidth <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span>
      num<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token function">animate</span><span class="token punctuation">(</span>ul<span class="token punctuation">,</span> <span class="token operator">-</span>num <span class="token operator">*</span> focusWidth<span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        flag <span class="token operator">=</span> <span class="token boolean">true</span><span class="token punctuation">;</span>
      <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token comment">// 点击左侧按钮，小圆圈跟随一起变化 可以再声明一个变量控制小圆圈的播放</span>
      circle<span class="token operator">--</span><span class="token punctuation">;</span>
      <span class="token comment">// 如果circle &lt; 0  说明第一张图片，则小圆圈要改为第4个小圆圈（3）</span>
      <span class="token comment">// if (circle &lt; 0) {</span>
      <span class="token comment">//     circle = ol.children.length - 1;</span>
      <span class="token comment">// }</span>
      circle <span class="token operator">=</span> circle <span class="token operator">&lt;</span> <span class="token number">0</span> <span class="token operator">?</span> ol<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length <span class="token operator">-</span> <span class="token number">1</span> <span class="token operator">:</span> circle<span class="token punctuation">;</span>
      <span class="token comment">// 调用函数</span>
      <span class="token function">circleChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

  <span class="token keyword">function</span> <span class="token function">circleChange</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 先清除其余小圆圈的current类名</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> ol<span class="token punctuation">.</span>children<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      ol<span class="token punctuation">.</span>children<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;&quot;</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span>
    <span class="token comment">// 留下当前的小圆圈的current类名</span>
    ol<span class="token punctuation">.</span>children<span class="token punctuation">[</span>circle<span class="token punctuation">]</span><span class="token punctuation">.</span>className <span class="token operator">=</span> <span class="token string">&quot;current&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 10. 自动播放轮播图</span>
  <span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token function">setInterval</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">//手动调用点击事件</span>
    arrow_r<span class="token punctuation">.</span><span class="token function">click</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">2000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br><span class="line-number">39</span><br><span class="line-number">40</span><br><span class="line-number">41</span><br><span class="line-number">42</span><br><span class="line-number">43</span><br><span class="line-number">44</span><br><span class="line-number">45</span><br><span class="line-number">46</span><br><span class="line-number">47</span><br><span class="line-number">48</span><br><span class="line-number">49</span><br><span class="line-number">50</span><br><span class="line-number">51</span><br><span class="line-number">52</span><br><span class="line-number">53</span><br><span class="line-number">54</span><br><span class="line-number">55</span><br><span class="line-number">56</span><br><span class="line-number">57</span><br><span class="line-number">58</span><br><span class="line-number">59</span><br><span class="line-number">60</span><br><span class="line-number">61</span><br><span class="line-number">62</span><br><span class="line-number">63</span><br><span class="line-number">64</span><br><span class="line-number">65</span><br><span class="line-number">66</span><br><span class="line-number">67</span><br><span class="line-number">68</span><br><span class="line-number">69</span><br><span class="line-number">70</span><br><span class="line-number">71</span><br><span class="line-number">72</span><br><span class="line-number">73</span><br><span class="line-number">74</span><br><span class="line-number">75</span><br><span class="line-number">76</span><br><span class="line-number">77</span><br><span class="line-number">78</span><br><span class="line-number">79</span><br><span class="line-number">80</span><br><span class="line-number">81</span><br><span class="line-number">82</span><br><span class="line-number">83</span><br><span class="line-number">84</span><br><span class="line-number">85</span><br><span class="line-number">86</span><br><span class="line-number">87</span><br><span class="line-number">88</span><br><span class="line-number">89</span><br><span class="line-number">90</span><br><span class="line-number">91</span><br><span class="line-number">92</span><br><span class="line-number">93</span><br><span class="line-number">94</span><br><span class="line-number">95</span><br><span class="line-number">96</span><br><span class="line-number">97</span><br><span class="line-number">98</span><br><span class="line-number">99</span><br><span class="line-number">100</span><br><span class="line-number">101</span><br><span class="line-number">102</span><br><span class="line-number">103</span><br><span class="line-number">104</span><br><span class="line-number">105</span><br><span class="line-number">106</span><br><span class="line-number">107</span><br><span class="line-number">108</span><br><span class="line-number">109</span><br><span class="line-number">110</span><br><span class="line-number">111</span><br><span class="line-number">112</span><br><span class="line-number">113</span><br><span class="line-number">114</span><br><span class="line-number">115</span><br><span class="line-number">116</span><br><span class="line-number">117</span><br><span class="line-number">118</span><br><span class="line-number">119</span><br><span class="line-number">120</span><br><span class="line-number">121</span><br><span class="line-number">122</span><br><span class="line-number">123</span><br><span class="line-number">124</span><br><span class="line-number">125</span><br><span class="line-number">126</span><br><span class="line-number">127</span><br></div></div><h2 id="_1-2-2-节流阀"><a href="#_1-2-2-节流阀" class="header-anchor">#</a> 1.2.2. 节流阀</h2> <p>防止轮播图按钮连续点击造成播放过快。</p> <p>节流阀目的：当上一个函数动画内容执行完毕，再去执行下一个函数动画，让事件无法连续触发。</p> <p>核心实现思路：利用回调函数，添加一个变量来控制，锁住函数和解锁函数。</p> <p>开始设置一个变量 var flag= true;</p> <p>If(flag){flag = false; do something}       关闭水龙头</p> <p>利用回调函数动画执行完毕， flag = true     打开水龙头</p> <h2 id="_1-2-3-案例-返回顶部"><a href="#_1-2-3-案例-返回顶部" class="header-anchor">#</a> 1.2.3. 案例：返回顶部</h2> <ol><li>带有动画的返回顶部</li> <li>此时可以继续使用我们封装的动画函数</li> <li>只需要把所有的 left 相关的值改为 跟 页面垂直滚动距离相关就可以了</li> <li>页面滚动了多少，可以通过 window.pageYOffset 得到</li> <li>最后是页面滚动，使用 window.scroll(x,y)</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">//1. 获取元素</span>
<span class="token keyword">var</span> sliderbar <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.slider-bar&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> banner <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.banner&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// banner.offestTop 就是被卷去头部的大小 一定要写到滚动的外面</span>
<span class="token keyword">var</span> bannerTop <span class="token operator">=</span> banner<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>
<span class="token comment">// 当我们侧边栏固定定位之后应该变化的数值</span>
<span class="token keyword">var</span> sliderbarTop <span class="token operator">=</span> sliderbar<span class="token punctuation">.</span>offsetTop <span class="token operator">-</span> bannerTop<span class="token punctuation">;</span>
<span class="token comment">// 获取main 主体元素</span>
<span class="token keyword">var</span> main <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.main&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> goBack <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.goBack&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">var</span> mainTop <span class="token operator">=</span> main<span class="token punctuation">.</span>offsetTop<span class="token punctuation">;</span>
<span class="token comment">// 2. 页面滚动事件 scroll</span>
document<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;scroll&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// console.log(11);</span>
  <span class="token comment">// window.pageYOffset 页面被卷去的头部</span>
  <span class="token comment">// console.log(window.pageYOffset);</span>
  <span class="token comment">// 3 .当我们页面被卷去的头部大于等于了 172 此时 侧边栏就要改为固定定位</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>pageYOffset <span class="token operator">&gt;=</span> bannerTop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    sliderbar<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">&quot;fixed&quot;</span><span class="token punctuation">;</span>
    sliderbar<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> sliderbarTop <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    sliderbar<span class="token punctuation">.</span>style<span class="token punctuation">.</span>position <span class="token operator">=</span> <span class="token string">&quot;absolute&quot;</span><span class="token punctuation">;</span>
    sliderbar<span class="token punctuation">.</span>style<span class="token punctuation">.</span>top <span class="token operator">=</span> <span class="token string">&quot;300px&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 4. 当我们页面滚动到main盒子，就显示 goback模块</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>window<span class="token punctuation">.</span>pageYOffset <span class="token operator">&gt;=</span> mainTop<span class="token punctuation">)</span> <span class="token punctuation">{</span>
    goBack<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;block&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token punctuation">{</span>
    goBack<span class="token punctuation">.</span>style<span class="token punctuation">.</span>display <span class="token operator">=</span> <span class="token string">&quot;none&quot;</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 3. 当我们点击了返回顶部模块，就让窗口滚动的页面的最上方</span>
goBack<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 里面的x和y 不跟单位的 直接写数字即可</span>
  <span class="token comment">// window.scroll(0, 0);</span>
  <span class="token comment">// 因为是窗口滚动 所以对象是window</span>
  <span class="token function">animate</span><span class="token punctuation">(</span>window<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br><span class="line-number">24</span><br><span class="line-number">25</span><br><span class="line-number">26</span><br><span class="line-number">27</span><br><span class="line-number">28</span><br><span class="line-number">29</span><br><span class="line-number">30</span><br><span class="line-number">31</span><br><span class="line-number">32</span><br><span class="line-number">33</span><br><span class="line-number">34</span><br><span class="line-number">35</span><br><span class="line-number">36</span><br><span class="line-number">37</span><br><span class="line-number">38</span><br></div></div><h2 id="_1-2-4-案例-筋头云案例"><a href="#_1-2-4-案例-筋头云案例" class="header-anchor">#</a> 1.2.4. 案例：筋头云案例</h2> <ol><li>利用动画函数做动画效果</li> <li>原先筋斗云的起始位置是 0</li> <li>鼠标经过某个小 li，把当前小 li 的 offsetLeft 位置做为目标值即可</li> <li>鼠标离开某个小 li，就把目标值设为 0</li> <li>如果点击了某个小 li， 就把 li 当前的位置存储起来，做为筋斗云的起始位置</li></ol> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>window<span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;load&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 1. 获取元素</span>
  <span class="token keyword">var</span> cloud <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.cloud&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> c_nav <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">&quot;.c-nav&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> lis <span class="token operator">=</span> c_nav<span class="token punctuation">.</span><span class="token function">querySelectorAll</span><span class="token punctuation">(</span><span class="token string">&quot;li&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 2. 给所有的小li绑定事件</span>
  <span class="token comment">// 这个current 做为筋斗云的起始位置</span>
  <span class="token keyword">var</span> current <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>
  <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">var</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> lis<span class="token punctuation">.</span>length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// (1) 鼠标经过把当前小li 的位置做为目标值</span>
    lis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mouseenter&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">animate</span><span class="token punctuation">(</span>cloud<span class="token punctuation">,</span> <span class="token keyword">this</span><span class="token punctuation">.</span>offsetLeft<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// (2) 鼠标离开就回到起始的位置</span>
    lis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;mouseleave&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">animate</span><span class="token punctuation">(</span>cloud<span class="token punctuation">,</span> current<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// (3) 当我们鼠标点击，就把当前位置做为目标值</span>
    lis<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">addEventListener</span><span class="token punctuation">(</span><span class="token string">&quot;click&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      current <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>offsetLeft<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br><span class="line-number">16</span><br><span class="line-number">17</span><br><span class="line-number">18</span><br><span class="line-number">19</span><br><span class="line-number">20</span><br><span class="line-number">21</span><br><span class="line-number">22</span><br><span class="line-number">23</span><br></div></div><h2 id="_1-3-触屏事件"><a href="#_1-3-触屏事件" class="header-anchor">#</a> 1.3. 触屏事件</h2> <h2 id="_1-3-1-触屏事件概述"><a href="#_1-3-1-触屏事件概述" class="header-anchor">#</a> 1.3.1. 触屏事件概述</h2> <p>移动端浏览器兼容性较好，我们不需要考虑以前 JS 的兼容性问题，可以放心的使用原生 JS 书写效果，但是移动端也有自己独特的地方。比如触屏事件 touch（也称触摸事件），Android 和 IOS 都有。</p> <p>touch 对象代表一个触摸点。触摸点可能是一根手指，也可能是一根触摸笔。触屏事件可响应用户手指（或触控笔）对屏幕或者触控板操作。</p> <p>常见的触屏事件如下：</p> <p><img src="/zz-web/assets/img/1.93c0cbcb.png" alt="1"></p> <h2 id="_1-3-2-触摸事件对象-touchevent"><a href="#_1-3-2-触摸事件对象-touchevent" class="header-anchor">#</a> 1.3.2. 触摸事件对象（TouchEvent）</h2> <p>TouchEvent  是一类描述手指在触摸平面（触摸屏、触摸板等）的状态变化的事件。这类事件用于描述一个或多个触点，使开发者可以检测触点的移动，触点的增加和减少，等等</p> <p>touchstart、touchmove、touchend 三个事件都会各自有事件对象。</p> <p>触摸事件对象重点我们看三个常见对象列表：</p> <p><img src="/zz-web/assets/img/2.c69c52ac.png" alt="2"></p> <blockquote><p><code>因为平时我们都是给元素注册触摸事件，所以重点记住 targetTocuhes</code></p></blockquote> <h2 id="_1-3-3-案例-移动端拖动元素"><a href="#_1-3-3-案例-移动端拖动元素" class="header-anchor">#</a> 1.3.3.案例：移动端拖动元素</h2> <ol><li><p>touchstart、touchmove、touchend 可以实现拖动元素</p></li> <li><p>但是拖动元素需要当前手指的坐标值 我们可以使用   targetTouches[0] 里面的 pageX 和 pageY</p></li> <li><p>移动端拖动的原理：    手指移动中，计算出手指移动的距离。然后用盒子原来的位置 + 手指移动的距离</p></li> <li><p>手指移动的距离：   手指滑动中的位置 减去   手指刚开始触摸的位置</p> <p>拖动元素三步曲：</p> <p>（1） 触摸元素 touchstart：  获取手指初始坐标，同时获得盒子原来的位置</p> <p>（2） 移动手指 touchmove：  计算手指的滑动距离，并且移动盒子</p> <p>（3） 离开手指 touchend:</p> <p><code>注意： 手指移动也会触发滚动屏幕所以这里要阻止默认的屏幕滚动 e.preventDefault();</code></p> <p>​</p></li></ol></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/zz-web/study/webAPI/day05/05.html" class="prev">
        Web APIs - day05
      </a></span> <span class="next"><a href="/zz-web/study/webAPI/day07/07.html">
        Web APIs - day07
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/zz-web/assets/js/app.083f945b.js" defer></script><script src="/zz-web/assets/js/2.f2240049.js" defer></script><script src="/zz-web/assets/js/44.e1c509f1.js" defer></script>
  </body>
</html>
