<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Ajax - day04 | 前端笔记</title>
    <meta name="generator" content="VuePress 1.8.2">
    
    <meta name="description" content="在线笔记">
    
    <link rel="preload" href="/zz-web/assets/css/0.styles.c0bfc3b1.css" as="style"><link rel="preload" href="/zz-web/assets/js/app.083f945b.js" as="script"><link rel="preload" href="/zz-web/assets/js/2.f2240049.js" as="script"><link rel="preload" href="/zz-web/assets/js/33.a0ee48f3.js" as="script"><link rel="prefetch" href="/zz-web/assets/js/10.d5312b28.js"><link rel="prefetch" href="/zz-web/assets/js/11.2b6aa850.js"><link rel="prefetch" href="/zz-web/assets/js/12.2ab2992b.js"><link rel="prefetch" href="/zz-web/assets/js/13.edf2fe2f.js"><link rel="prefetch" href="/zz-web/assets/js/14.9f97b9d2.js"><link rel="prefetch" href="/zz-web/assets/js/15.0493a36c.js"><link rel="prefetch" href="/zz-web/assets/js/16.03213685.js"><link rel="prefetch" href="/zz-web/assets/js/17.73d68c4e.js"><link rel="prefetch" href="/zz-web/assets/js/18.12075e8a.js"><link rel="prefetch" href="/zz-web/assets/js/19.498e8181.js"><link rel="prefetch" href="/zz-web/assets/js/20.f2ff5235.js"><link rel="prefetch" href="/zz-web/assets/js/21.91a2fc69.js"><link rel="prefetch" href="/zz-web/assets/js/22.a727aa87.js"><link rel="prefetch" href="/zz-web/assets/js/23.380e54c9.js"><link rel="prefetch" href="/zz-web/assets/js/24.c12d12df.js"><link rel="prefetch" href="/zz-web/assets/js/25.8f557342.js"><link rel="prefetch" href="/zz-web/assets/js/26.b4ebb45d.js"><link rel="prefetch" href="/zz-web/assets/js/27.1a9df948.js"><link rel="prefetch" href="/zz-web/assets/js/28.58b2b7c8.js"><link rel="prefetch" href="/zz-web/assets/js/29.872a74a7.js"><link rel="prefetch" href="/zz-web/assets/js/3.96bb5801.js"><link rel="prefetch" href="/zz-web/assets/js/30.e767d85b.js"><link rel="prefetch" href="/zz-web/assets/js/31.2a66bb00.js"><link rel="prefetch" href="/zz-web/assets/js/32.4b3ae917.js"><link rel="prefetch" href="/zz-web/assets/js/34.b1e111ac.js"><link rel="prefetch" href="/zz-web/assets/js/35.70b67615.js"><link rel="prefetch" href="/zz-web/assets/js/36.c8a1f895.js"><link rel="prefetch" href="/zz-web/assets/js/37.7830b613.js"><link rel="prefetch" href="/zz-web/assets/js/38.aaaab44a.js"><link rel="prefetch" href="/zz-web/assets/js/39.5fe7a1ec.js"><link rel="prefetch" href="/zz-web/assets/js/4.c3d1ea14.js"><link rel="prefetch" href="/zz-web/assets/js/40.54e98467.js"><link rel="prefetch" href="/zz-web/assets/js/41.4dc705c1.js"><link rel="prefetch" href="/zz-web/assets/js/42.9c9fa6be.js"><link rel="prefetch" href="/zz-web/assets/js/43.2be21763.js"><link rel="prefetch" href="/zz-web/assets/js/44.e1c509f1.js"><link rel="prefetch" href="/zz-web/assets/js/45.3d0ca188.js"><link rel="prefetch" href="/zz-web/assets/js/46.c08d3f05.js"><link rel="prefetch" href="/zz-web/assets/js/47.5b9b3830.js"><link rel="prefetch" href="/zz-web/assets/js/48.8dd0953b.js"><link rel="prefetch" href="/zz-web/assets/js/49.fa9cde16.js"><link rel="prefetch" href="/zz-web/assets/js/5.095b1679.js"><link rel="prefetch" href="/zz-web/assets/js/50.dd3e5c49.js"><link rel="prefetch" href="/zz-web/assets/js/51.e93f43fb.js"><link rel="prefetch" href="/zz-web/assets/js/52.00aba65d.js"><link rel="prefetch" href="/zz-web/assets/js/53.2e7de842.js"><link rel="prefetch" href="/zz-web/assets/js/54.9624d966.js"><link rel="prefetch" href="/zz-web/assets/js/6.dd5c96ae.js"><link rel="prefetch" href="/zz-web/assets/js/7.29dbb4cd.js"><link rel="prefetch" href="/zz-web/assets/js/8.dc4bd71f.js"><link rel="prefetch" href="/zz-web/assets/js/9.81b641cc.js">
    <link rel="stylesheet" href="/zz-web/assets/css/0.styles.c0bfc3b1.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/zz-web/" class="home-link router-link-active"><img src="./logo.png" alt="前端笔记" class="logo"> <span class="site-name can-hide">前端笔记</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/zz-web/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程笔记" class="dropdown-title"><span class="title">课程笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程笔记" class="mobile-dropdown-title"><span class="title">课程笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          课程笔记
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zz-web/study/webAPI/day01/01.html" class="nav-link">
  WebApi
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/JS基础/js-day01/01.html" class="nav-link">
  JS基础
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Jquery/day01/01.html" class="nav-link">
  Jquery
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Eacharts/day01/01.html" class="nav-link">
  数据可视化
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Js高级/day01/JavaScript高级第01天笔记.html" class="nav-link">
  JS高级
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/AJAX/day01/01.html" class="nav-link">
  Ajax
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Git/day01/01.html" class="nav-link">
  Git
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/BigEvent/day01/01.html" class="nav-link">
  大事件
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/NodeJs/day01/01.html" class="nav-link">
  NodeJs
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Vue基础/Day01/01.html" class="nav-link">
  Vue基础
</a></li></ul></li></ul></div></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/zz-web/" class="nav-link">
  主页
</a></div><div class="nav-item"><div class="dropdown-wrapper"><button type="button" aria-label="课程笔记" class="dropdown-title"><span class="title">课程笔记</span> <span class="arrow down"></span></button> <button type="button" aria-label="课程笔记" class="mobile-dropdown-title"><span class="title">课程笔记</span> <span class="arrow right"></span></button> <ul class="nav-dropdown" style="display:none;"><li class="dropdown-item"><h4>
          课程笔记
        </h4> <ul class="dropdown-subitem-wrapper"><li class="dropdown-subitem"><a href="/zz-web/study/webAPI/day01/01.html" class="nav-link">
  WebApi
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/JS基础/js-day01/01.html" class="nav-link">
  JS基础
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Jquery/day01/01.html" class="nav-link">
  Jquery
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Eacharts/day01/01.html" class="nav-link">
  数据可视化
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Js高级/day01/JavaScript高级第01天笔记.html" class="nav-link">
  JS高级
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/AJAX/day01/01.html" class="nav-link">
  Ajax
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Git/day01/01.html" class="nav-link">
  Git
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/BigEvent/day01/01.html" class="nav-link">
  大事件
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/NodeJs/day01/01.html" class="nav-link">
  NodeJs
</a></li><li class="dropdown-subitem"><a href="/zz-web/study/Vue基础/Day01/01.html" class="nav-link">
  Vue基础
</a></li></ul></li></ul></div></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/zz-web/study/AJAX/day01/01.html" class="sidebar-link">Ajax - day01</a></li><li><a href="/zz-web/study/AJAX/day02/02.html" class="sidebar-link">Ajax - day02</a></li><li><a href="/zz-web/study/AJAX/day03/03.html" class="sidebar-link">Ajax - day03</a></li><li><a href="/zz-web/study/AJAX/day04/04.html" aria-current="page" class="active sidebar-link">Ajax - day04</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#什么是同源" class="sidebar-link">什么是同源</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#什么是同源策略" class="sidebar-link">什么是同源策略</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#什么是跨域" class="sidebar-link">什么是跨域</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#浏览器对跨域请求的拦截" class="sidebar-link">浏览器对跨域请求的拦截</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#如何实现跨域数据请求" class="sidebar-link">如何实现跨域数据请求</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#什么是jsonp-⭐⭐⭐" class="sidebar-link">什么是JSONP(⭐⭐⭐)</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#jsonp的实现原理-⭐⭐⭐" class="sidebar-link">JSONP的实现原理(⭐⭐⭐)</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#自己实现一个简单的jsonp" class="sidebar-link">自己实现一个简单的JSONP</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#jsonp的缺点" class="sidebar-link">JSONP的缺点</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#jquery中的jsonp" class="sidebar-link">jQuery中的JSONP</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#自定义参数及回调函数名称" class="sidebar-link">自定义参数及回调函数名称</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#jquery中jsonp的实现过程" class="sidebar-link">jQuery中JSONP的实现过程</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#要实现的ui效果" class="sidebar-link">要实现的UI效果</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#获取用户输入的搜索关键词" class="sidebar-link">获取用户输入的搜索关键词</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#封装getsuggestlist函数" class="sidebar-link">封装getSuggestList函数</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#渲染建议列表的ui结构" class="sidebar-link">渲染建议列表的UI结构</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#定义搜索建议列表" class="sidebar-link">定义搜索建议列表</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#定义模板结构" class="sidebar-link">定义模板结构</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#定义渲染模板结构的函数" class="sidebar-link">定义渲染模板结构的函数</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#搜索关键词为空时隐藏搜索建议列表" class="sidebar-link">搜索关键词为空时隐藏搜索建议列表</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#输入框防抖" class="sidebar-link">输入框防抖</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#什么是防抖-⭐⭐⭐" class="sidebar-link">什么是防抖(⭐⭐⭐)</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#防抖的应用场景" class="sidebar-link">防抖的应用场景</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#实现输入框的防抖" class="sidebar-link">实现输入框的防抖</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#缓存搜索的建议列表" class="sidebar-link">缓存搜索的建议列表</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#定义全局缓存对象" class="sidebar-link">定义全局缓存对象</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#将搜索结果保存到缓存对象中" class="sidebar-link">将搜索结果保存到缓存对象中</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#优先从缓存中获取搜索建议" class="sidebar-link">优先从缓存中获取搜索建议</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#节流" class="sidebar-link">节流</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#什么是节流-⭐⭐⭐" class="sidebar-link">什么是节流(⭐⭐⭐)</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#节流的应用场景" class="sidebar-link">节流的应用场景</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#节流案例-鼠标跟随效果" class="sidebar-link">节流案例 – 鼠标跟随效果</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#节流阀的概念" class="sidebar-link">节流阀的概念</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#使用节流优化鼠标跟随效果" class="sidebar-link">使用节流优化鼠标跟随效果</a></li><li class="sidebar-sub-header"><a href="/zz-web/study/AJAX/day04/04.html#总结防抖和节流的区别" class="sidebar-link">总结防抖和节流的区别</a></li></ul></li><li><a href="/zz-web/study/AJAX/day05/05.html" class="sidebar-link">Ajax - day05</a></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><h1 id="ajax-day04"><a href="#ajax-day04" class="header-anchor">#</a> Ajax - day04</h1> <ul><li>能够知道什么是同源策略和跨域</li> <li>能够知道什么是<code>JSONP</code></li> <li>能够说出<code>JSONP</code>的实现原理</li> <li>能够知道防抖和节流的概念</li></ul> <h1 id="同源策略-⭐⭐⭐"><a href="#同源策略-⭐⭐⭐" class="header-anchor">#</a> 同源策略(⭐⭐⭐)</h1> <h2 id="什么是同源"><a href="#什么是同源" class="header-anchor">#</a> 什么是同源</h2> <p>如果两个页面的协议，域名和端口都相同，则两个页面具有<strong>相同的源</strong>。</p> <p>例如，下表给出了相对于 http://www.test.com/index.html 页面的同源检测：</p> <p><img src="/zz-web/assets/img/1.dd45fa1d.png" alt=""></p> <h2 id="什么是同源策略"><a href="#什么是同源策略" class="header-anchor">#</a> 什么是同源策略</h2> <p><strong>同源策略</strong>（英文全称 Same origin policy）是<strong>浏览器</strong>提供的一个<strong>安全功能</strong></p> <p><strong><code>MDN</code> 官方给定的概念</strong>：同源策略限制了从同一个源加载的文档或脚本如何与来自另一个源的资源进行交互。这</p> <p>是一个用于隔离潜在恶意文件的重要安全机制</p> <p>通俗的理解：浏览器规定，A 网站的 JavaScript，不允许和非同源的网站 C 之间，进行资源的交互，例如：</p> <p>① 无法读取非同源网页的 Cookie、LocalStorage 和 IndexedDB</p> <p>② 无法接触非同源网页的 DOM</p> <p>③ 无法向非同源地址发送 Ajax 请求</p> <h1 id="跨域-⭐⭐⭐"><a href="#跨域-⭐⭐⭐" class="header-anchor">#</a> 跨域(⭐⭐⭐)</h1> <h2 id="什么是跨域"><a href="#什么是跨域" class="header-anchor">#</a> 什么是跨域</h2> <p><strong>同源</strong>指的是两个 URL 的协议、域名、端口一致，反之，则是<strong>跨域</strong></p> <p>出现跨域的根本原因：<strong>浏览器的同源策略</strong>不允许非同源的 URL 之间进行资源的交互</p> <p>网页：<code>http://www.test.com/index.html</code></p> <p>接口：<code>http://www.api.com/userlist</code></p> <h2 id="浏览器对跨域请求的拦截"><a href="#浏览器对跨域请求的拦截" class="header-anchor">#</a> 浏览器对跨域请求的拦截</h2> <p><img src="/zz-web/assets/img/2.a8f665d5.png" alt=""></p> <p>**注意：**浏览器允许发起跨域请求，但是，跨域请求回来的数据，会被浏览器拦截，无法被页面获取到！</p> <h2 id="如何实现跨域数据请求"><a href="#如何实现跨域数据请求" class="header-anchor">#</a> 如何实现跨域数据请求</h2> <p>现如今，实现跨域数据请求，最主要的两种解决方案，分别是 <code>JSONP</code> 和 <code>CORS</code>。</p> <p>**<code>JSONP</code>：**出现的早，兼容性好（兼容低版本 IE）。是前端程序员为了解决跨域问题，被迫想出来的一种临时解决方案。<strong>缺点</strong>是只支持 <code>GET</code> 请求，不支持 <code>POST</code> 请求。</p> <p>**<code>CORS</code>：**出现的较晚，它是 <code>W3C</code> 标准，属于跨域 <code>Ajax</code> 请求的根本解决方案。支持 <code>GET</code> 和 <code>POST</code> 请求。<strong>缺点</strong>是不兼容某些低版本的浏览器</p> <h1 id="jsonp"><a href="#jsonp" class="header-anchor">#</a> <code>JSONP</code></h1> <h2 id="什么是jsonp-⭐⭐⭐"><a href="#什么是jsonp-⭐⭐⭐" class="header-anchor">#</a> 什么是<code>JSONP</code>(⭐⭐⭐)</h2> <p><code>JSONP</code> (<code>JSON with Padding</code>) 是 <code>JSON</code> 的一种“使用模式”，可用于解决主流浏览器的跨域数据访问的问题。</p> <h2 id="jsonp的实现原理-⭐⭐⭐"><a href="#jsonp的实现原理-⭐⭐⭐" class="header-anchor">#</a> <code>JSONP</code>的实现原理(⭐⭐⭐)</h2> <p>由于浏览器同源策略的限制，网页中无法通过 Ajax 请求非同源的接口数据。但是 <code>&lt;script&gt;</code> 标签不受浏览器同</p> <p>源策略的影响，可以通过 <code>src</code> 属性，请求非同源的 <code>js</code> 脚本。</p> <p>因此，<code>JSONP</code> 的实现原理，就是通过 <code>&lt;script&gt;</code> 标签的 <code>src</code> 属性，请求跨域的数据接口，并通过<strong>函数调用</strong>的形式，接收跨域接口响应回来的数据</p> <h2 id="自己实现一个简单的jsonp"><a href="#自己实现一个简单的jsonp" class="header-anchor">#</a> 自己实现一个简单的<code>JSONP</code></h2> <p>定义一个<code>success</code>回调函数：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token keyword">function</span> <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">data</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;获取到了data数据：&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><p>通过 <code>&lt;script&gt;</code> 标签，请求接口数据：</p> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>http://www.liulongbin.top:3006/api/jsonp?callback=success&amp;name=zs&amp;a
ge=20<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="jsonp的缺点"><a href="#jsonp的缺点" class="header-anchor">#</a> <code>JSONP</code>的缺点</h2> <p>由于 <code>JSONP</code> 是通过 <code>&lt;script&gt;</code> 标签的 <code>src</code> 属性，来实现跨域数据获取的，所以，<code>JSONP</code> 只支持 <code>GET</code> 数据请求，不支持 POST 请求。</p> <p><strong>注意：</strong> <strong><code>JSONP</code> 和 Ajax 之间没有任何关系</strong>，不能把 <code>JSONP</code> 请求数据的方式叫做 Ajax，因为 <code>JSONP</code> 没有用到</p> <p><code>XMLHttpRequest</code> 这个对象</p> <h2 id="jquery中的jsonp"><a href="#jquery中的jsonp" class="header-anchor">#</a> <code>jQuery</code>中的<code>JSONP</code></h2> <p><code>jQuery</code> 提供的 <code>$.ajax()</code> 函数，除了可以发起真正的 <code>Ajax</code> 数据请求之外，还能够发起 <code>JSONP</code> 数据请求，例如：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&quot;http://www.liulongbin.top:3006/api/jsonp?name=zs&amp;age=20&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 如果要使用 $.ajax() 发起 JSONP 请求，必须指定 datatype 为 jsonp</span>
  dataType<span class="token operator">:</span> <span class="token string">&quot;jsonp&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><p>默认情况下，使用 <code>jQuery</code> 发起 <code>JSONP</code> 请求，会自动携带一个 c<code>allback=jQueryxxx</code> 的参数，<code>jQueryxxx</code> 是随机生成的一个回调函数名称</p> <h2 id="自定义参数及回调函数名称"><a href="#自定义参数及回调函数名称" class="header-anchor">#</a> 自定义参数及回调函数名称</h2> <p>在使用 <code>jQuery</code> 发起 <code>JSONP</code> 请求时，如果想要自定义 <code>JSONP</code> 的<strong>参数</strong>以及<strong>回调函数名称</strong>，可以通过如下两个参数来指定：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code>$<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
  url<span class="token operator">:</span> <span class="token string">&quot;http://www.liulongbin.top:3006/api/jsonp?name=zs&amp;age=20&quot;</span><span class="token punctuation">,</span>
  dataType<span class="token operator">:</span> <span class="token string">&quot;jsonp&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 发送到服务端的参数名称，默认值为 callback</span>
  jsonp<span class="token operator">:</span> <span class="token string">&quot;callback&quot;</span><span class="token punctuation">,</span>
  <span class="token comment">// 自定义的回调函数名称，默认值为 jQueryxxx 格式</span>
  jsonpCallback<span class="token operator">:</span> <span class="token string">&quot;abc&quot;</span><span class="token punctuation">,</span>
  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="jquery中jsonp的实现过程"><a href="#jquery中jsonp的实现过程" class="header-anchor">#</a> <code>jQuery</code>中<code>JSONP</code>的实现过程</h2> <p><code>jQuery</code> 中的 <code>JSONP</code>，也是通过 <code>&lt;script&gt;</code> 标签的 <code>src</code> 属性实现跨域数据访问的，只不过，<code>jQuery</code> 采用的是<strong>动态创建和移除标签</strong>的方式，来发起 <code>JSONP</code> 数据请求。</p> <ul><li><p>在发起 <code>JSONP</code> 请求的时候，动态向 <code>&lt;header&gt;</code> 中 append 一个 <code>&lt;script&gt;</code> 标签；</p></li> <li><p>在 <code>JSONP</code> 请求成功以后，动态从 <code>&lt;header&gt;</code> 中移除刚才 <code>append</code> 进去的 <code>&lt;script&gt;</code> 标签；</p></li></ul> <h1 id="案例-淘宝搜索"><a href="#案例-淘宝搜索" class="header-anchor">#</a> <strong>案例</strong> <strong>–</strong> 淘宝搜索</h1> <h2 id="要实现的ui效果"><a href="#要实现的ui效果" class="header-anchor">#</a> 要实现的<code>UI</code>效果</h2> <p><img src="/zz-web/assets/img/3.854a0016.png" alt=""></p> <h2 id="获取用户输入的搜索关键词"><a href="#获取用户输入的搜索关键词" class="header-anchor">#</a> 获取用户输入的搜索关键词</h2> <p>为了获取到用户每次按下键盘输入的内容，需要监听输入框的 <code>keyup</code> 事件，示例代码如下：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 监听文本框的 keyup 事件</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#ipt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;keyup&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取用户输入的内容</span>
  <span class="token keyword">var</span> keywords <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 判断用户输入的内容是否为空</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>keywords<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// TODO：获取搜索建议列表</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="封装getsuggestlist函数"><a href="#封装getsuggestlist函数" class="header-anchor">#</a> 封装<code>getSuggestList</code>函数</h2> <p>将获取搜索建议列表的代码，封装到 <code>getSuggestList</code> 函数中，示例代码如下：</p> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">function</span> <span class="token function">getSuggestList</span><span class="token punctuation">(</span><span class="token parameter">kw</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  $<span class="token punctuation">.</span><span class="token function">ajax</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token comment">// 指定请求的 URL 地址，其中，q 是用户输入的关键字</span>
    url<span class="token operator">:</span> <span class="token string">&quot;https://suggest.taobao.com/sug?q=&quot;</span> <span class="token operator">+</span> kw<span class="token punctuation">,</span>
    <span class="token comment">// 指定要发起的是 JSONP 请求</span>
    dataType<span class="token operator">:</span> <span class="token string">&quot;jsonp&quot;</span><span class="token punctuation">,</span>
    <span class="token comment">// 成功的回调函数</span>
    <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br></div></div><h2 id="渲染建议列表的ui结构"><a href="#渲染建议列表的ui结构" class="header-anchor">#</a> 渲染建议列表的<code>UI</code>结构</h2> <h2 id="定义搜索建议列表"><a href="#定义搜索建议列表" class="header-anchor">#</a> 定义搜索建议列表</h2> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- tab 栏区域 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tabs<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 搜索区域 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>search-box<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
  <span class="token comment">&lt;!-- 搜索建议列表 --&gt;</span>
  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>suggest-list<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br></div></div><h2 id="定义模板结构"><a href="#定义模板结构" class="header-anchor">#</a> 定义模板结构</h2> <ul><li>创建<code>script</code>标签</li> <li>设置<code>type</code>属性为 <code>text/html</code> 设置模板<code>id</code></li> <li>利用 <code>each</code> 遍历结构</li></ul> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- 模板结构 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>text/html<span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>tpl-suggestList<span class="token punctuation">&quot;</span></span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript">
  <span class="token punctuation">{</span><span class="token punctuation">{</span>each result<span class="token punctuation">}</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span>div <span class="token keyword">class</span><span class="token operator">=</span><span class="token string">&quot;suggest-item&quot;</span><span class="token operator">&gt;</span><span class="token punctuation">{</span><span class="token punctuation">{</span>$value<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">{</span><span class="token punctuation">{</span><span class="token operator">/</span>each<span class="token punctuation">}</span><span class="token punctuation">}</span>
</span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br></div></div><h2 id="定义渲染模板结构的函数"><a href="#定义渲染模板结构的函数" class="header-anchor">#</a> 定义渲染模板结构的函数</h2> <ul><li>定义函数，接收一个参数，就是服务器返回的数据</li> <li>判断返回的数据长度是否大于 0</li> <li>如果没有，将页面的列表清空，并且进行隐藏</li> <li>如果有数据，调用模板的 <code>template</code> 函数，传入<code>id</code>和数据</li> <li>返回渲染好的<code>html</code>字符串，然后放入容器中</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 渲染建议列表</span>
<span class="token keyword">function</span> <span class="token function">renderSuggestList</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 如果没有需要渲染的数据，则直接 return</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>result<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#suggest-list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 渲染模板结构</span>
  <span class="token keyword">var</span> htmlStr <span class="token operator">=</span> <span class="token function">template</span><span class="token punctuation">(</span><span class="token string">&quot;tpl-suggestList&quot;</span><span class="token punctuation">,</span> res<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#suggest-list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">html</span><span class="token punctuation">(</span>htmlStr<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="搜索关键词为空时隐藏搜索建议列表"><a href="#搜索关键词为空时隐藏搜索建议列表" class="header-anchor">#</a> 搜索关键词为空时隐藏搜索建议列表</h2> <ul><li>注册<code>keyup</code>事件</li> <li>判断输入框的内容是否为空</li> <li>如果为空隐藏列表</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#ipt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;keyup&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取用户输入的内容</span>
  <span class="token keyword">var</span> keywords <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 判断用户输入的内容是否为空</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>keywords<span class="token punctuation">.</span>length <span class="token operator">&lt;=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 如果关键词为空，则清空后隐藏搜索建议列表</span>
    <span class="token keyword">return</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#suggest-list&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">empty</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">hide</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token function">getSuggestList</span><span class="token punctuation">(</span>keywords<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h1 id="防抖-节流"><a href="#防抖-节流" class="header-anchor">#</a> 防抖&amp;节流</h1> <h2 id="输入框防抖"><a href="#输入框防抖" class="header-anchor">#</a> 输入框防抖</h2> <h2 id="什么是防抖-⭐⭐⭐"><a href="#什么是防抖-⭐⭐⭐" class="header-anchor">#</a> 什么是防抖(⭐⭐⭐)</h2> <p><strong>防抖策略</strong>（<code>debounce</code>）是当事件被触发后，延迟 <code>n</code> 秒后再执行回调，如果在这 <code>n</code> 秒内事件又被触发，则重新计时。</p> <p><img src="/zz-web/assets/img/4.5e88d21b.png" alt=""></p> <p>**好处：**能够保证用户在频繁触发某些事件的时候，不会频繁的执行回调，只会被执行一次</p> <h2 id="防抖的应用场景"><a href="#防抖的应用场景" class="header-anchor">#</a> 防抖的应用场景</h2> <p>用户在输入框中连续输入一串字符时，可以通过防抖策略，只在输入完后，才执行查询的请求，这样可以有效减</p> <p>少请求次数，节约请求资源；</p> <h2 id="实现输入框的防抖"><a href="#实现输入框的防抖" class="header-anchor">#</a> 实现输入框的防抖</h2> <ul><li>防抖动的 timer</li> <li>定义防抖的函数，函数里面定义一个延时器，在演示器里面调用发起<code>JSONP</code>的请求</li> <li>在触发 <code>keyup</code> 事件时，立即清空 <code>timer</code>，然后调用防抖的函数</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 1. 防抖动的 timer</span>
<span class="token keyword">function</span> <span class="token function">debounceSearch</span><span class="token punctuation">(</span><span class="token parameter">keywords</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 2. 定义防抖的函数</span>
  timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 发起 JSONP 请求</span>
    <span class="token function">getSuggestList</span><span class="token punctuation">(</span>keywords<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">500</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#ipt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;keyup&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 3. 在触发 keyup 事件时，立即清空 timer</span>
  <span class="token function">clearTimeout</span><span class="token punctuation">(</span>timer<span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// ...省略其他代码</span>
  <span class="token function">debounceSearch</span><span class="token punctuation">(</span>keywords<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br></div></div><h2 id="缓存搜索的建议列表"><a href="#缓存搜索的建议列表" class="header-anchor">#</a> 缓存搜索的建议列表</h2> <h2 id="定义全局缓存对象"><a href="#定义全局缓存对象" class="header-anchor">#</a> 定义全局缓存对象</h2> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 缓存对象</span>
<span class="token keyword">var</span> cacheObj <span class="token operator">=</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br></div></div><h2 id="将搜索结果保存到缓存对象中"><a href="#将搜索结果保存到缓存对象中" class="header-anchor">#</a> 将搜索结果保存到缓存对象中</h2> <ul><li>键就是用户输入的关键字，值就是服务器返回的 value</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 渲染建议列表</span>
<span class="token keyword">function</span> <span class="token function">renderSuggestList</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...省略其他代码</span>
  <span class="token comment">// 将搜索的结果，添加到缓存对象中</span>
  <span class="token keyword">var</span> k <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#ipt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">val</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">trim</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  cacheObj<span class="token punctuation">[</span>k<span class="token punctuation">]</span> <span class="token operator">=</span> res<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br></div></div><h2 id="优先从缓存中获取搜索建议"><a href="#优先从缓存中获取搜索建议" class="header-anchor">#</a> 优先从缓存中获取搜索建议</h2> <ul><li>在发起请求之前，先判断缓存中是否有数据</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token comment">// 监听文本框的 keyup 事件</span>
<span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#ipt&quot;</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;keyup&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// ...省略其他代码</span>
  <span class="token comment">// 优先从缓存中获取搜索建议</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span>cacheObj<span class="token punctuation">[</span>keywords<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token function">renderSuggestList</span><span class="token punctuation">(</span>cacheObj<span class="token punctuation">[</span>keywords<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
  <span class="token comment">// 获取搜索建议列表</span>
  <span class="token function">debounceSearch</span><span class="token punctuation">(</span>keywords<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br></div></div><h2 id="节流"><a href="#节流" class="header-anchor">#</a> 节流</h2> <h2 id="什么是节流-⭐⭐⭐"><a href="#什么是节流-⭐⭐⭐" class="header-anchor">#</a> 什么是节流(⭐⭐⭐)</h2> <p><strong>节流策略</strong>（<code>throttle</code>），顾名思义，可以减少一段时间内事件的触发频率。</p> <p><img src="/zz-web/assets/img/5.6e3d3356.png" alt=""></p> <h2 id="节流的应用场景"><a href="#节流的应用场景" class="header-anchor">#</a> 节流的应用场景</h2> <p>① 鼠标连续不断地触发某事件（如点击），只在单位时间内只触发一次；</p> <p>② 懒加载时要监听计算滚动条的位置，但不必每次滑动都触发，可以降低计算的频率，而不必去浪费 CPU 资源；</p> <h2 id="节流案例-鼠标跟随效果"><a href="#节流案例-鼠标跟随效果" class="header-anchor">#</a> <strong>节流案例</strong> <strong>–</strong> 鼠标跟随效果</h2> <h4 id="ui效果"><a href="#ui效果" class="header-anchor">#</a> <code>UI</code>效果</h4> <p><img src="/zz-web/assets/img/6.ebdbdab7.png" alt=""></p> <h4 id="渲染ui结构并美化样式"><a href="#渲染ui结构并美化样式" class="header-anchor">#</a> 渲染<code>UI</code>结构并美化样式</h4> <div class="language-html line-numbers-mode"><pre class="language-html"><code><span class="token comment">&lt;!-- UI 结构 --&gt;</span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>img</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>./assets/angel.gif<span class="token punctuation">&quot;</span></span> <span class="token attr-name">alt</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span><span class="token punctuation">&quot;</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">&quot;</span>angel<span class="token punctuation">&quot;</span></span> <span class="token punctuation">/&gt;</span></span>
/* CSS 样式 */ html, body { margin: 0; padding: 0; overflow: hidden; } #angel {
position: absolute; }
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br></div></div><h4 id="不使用节流时实现鼠标跟随效果"><a href="#不使用节流时实现鼠标跟随效果" class="header-anchor">#</a> 不使用节流时实现鼠标跟随效果</h4> <ul><li>获取图片元素</li> <li>注册 <code>mousemove</code>事件</li> <li>设置图片的位置</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token comment">// 获取图片元素</span>
  <span class="token keyword">var</span> angel <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#angel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token comment">// 监听文档的 mousemove 事件</span>
  <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;mousemove&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">// 设置图片的位置</span>
    <span class="token function">$</span><span class="token punctuation">(</span>angel<span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;left&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>pageX <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;top&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>pageY <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br></div></div><h2 id="节流阀的概念"><a href="#节流阀的概念" class="header-anchor">#</a> 节流阀的概念</h2> <p>高铁卫生间是否被占用，由红绿灯控制，红灯表示被占用，绿灯表示可使用。</p> <p>假设每个人上卫生间都需要花费 5 分钟，则五分钟之内，被占用的卫生间无法被其他人使用。</p> <p>上一个人使用完毕后，需要将红灯<strong>重置</strong>为绿灯，表示下一个人可以使用卫生间。</p> <p>下一个人在上卫生间之前，需要<strong>先判断控制灯</strong>是否为绿色，来知晓能否上卫生间。</p> <p>节流阀为空，表示可以执行下次操作；不为空，表示不能执行下次操作。</p> <p>当前操作执行完，必须将节流阀<strong>重置</strong>为空，表示可以执行下次操作了。</p> <p>每次执行操作前，必须<strong>先判断节流阀是否为空</strong>。</p> <h2 id="使用节流优化鼠标跟随效果"><a href="#使用节流优化鼠标跟随效果" class="header-anchor">#</a> 使用节流优化鼠标跟随效果</h2> <ul><li>预定义一个 timer <strong>节流阀</strong></li> <li>当设置了鼠标跟随效果后，<strong>清空</strong> <strong>timer</strong> <strong>节流阀</strong>，方便下次开启延时器</li> <li>执行事件的时候判断<strong>节流阀</strong>是否为空，如果不为空，则证明距离上次执行间隔不足 16 毫秒</li></ul> <div class="language-javascript line-numbers-mode"><pre class="language-javascript"><code><span class="token function">$</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">var</span> angel <span class="token operator">=</span> <span class="token function">$</span><span class="token punctuation">(</span><span class="token string">&quot;#angel&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">var</span> timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 1.预定义一个 timer 节流阀</span>
  <span class="token function">$</span><span class="token punctuation">(</span>document<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">on</span><span class="token punctuation">(</span><span class="token string">&quot;mousemove&quot;</span><span class="token punctuation">,</span> <span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">e</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span>timer<span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token keyword">return</span><span class="token punctuation">;</span>
    <span class="token punctuation">}</span> <span class="token comment">// 3.判断节流阀是否为空，如果不为空，则证明距离上次执行间隔不足16毫秒</span>
    timer <span class="token operator">=</span> <span class="token function">setTimeout</span><span class="token punctuation">(</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
      <span class="token function">$</span><span class="token punctuation">(</span>angel<span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;left&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>pageX <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">)</span>
        <span class="token punctuation">.</span><span class="token function">css</span><span class="token punctuation">(</span><span class="token string">&quot;top&quot;</span><span class="token punctuation">,</span> e<span class="token punctuation">.</span>pageY <span class="token operator">+</span> <span class="token string">&quot;px&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      timer <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span> <span class="token comment">// 2.当设置了鼠标跟随效果后，清空 timer 节流阀，方便下次开启延时器</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre> <div class="line-numbers-wrapper"><span class="line-number">1</span><br><span class="line-number">2</span><br><span class="line-number">3</span><br><span class="line-number">4</span><br><span class="line-number">5</span><br><span class="line-number">6</span><br><span class="line-number">7</span><br><span class="line-number">8</span><br><span class="line-number">9</span><br><span class="line-number">10</span><br><span class="line-number">11</span><br><span class="line-number">12</span><br><span class="line-number">13</span><br><span class="line-number">14</span><br><span class="line-number">15</span><br></div></div><h2 id="总结防抖和节流的区别"><a href="#总结防抖和节流的区别" class="header-anchor">#</a> 总结防抖和节流的区别</h2> <ul><li><p><strong>防抖</strong>：如果事件被频繁触发，防抖能保证只有最有一次触发生效！前面 N 多次的触发都会被忽略！</p></li> <li><p><strong>节流</strong>：如果事件被频繁触发，节流能够减少事件触发的频率，因此，节流是有选择性地执行一部分事件！</p></li></ul></div> <footer class="page-edit"><!----> <!----></footer> <div class="page-nav"><p class="inner"><span class="prev">
      ←
      <a href="/zz-web/study/AJAX/day03/03.html" class="prev">
        Ajax - day03
      </a></span> <span class="next"><a href="/zz-web/study/AJAX/day05/05.html">
        Ajax - day05
      </a>
      →
    </span></p></div> </main></div><div class="global-ui"></div></div>
    <script src="/zz-web/assets/js/app.083f945b.js" defer></script><script src="/zz-web/assets/js/2.f2240049.js" defer></script><script src="/zz-web/assets/js/33.a0ee48f3.js" defer></script>
  </body>
</html>
